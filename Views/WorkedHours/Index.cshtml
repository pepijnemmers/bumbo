@using BumboApp.ViewModels
@using BumboApp.Views.Components
@using System.Globalization
@model BumboApp.ViewModels.WorkedHoursPageViewModel
@{
    ViewData["Title"] = "Gewerkte uren";
}

<div class="d-flex align-items-center w-100 w-lg-auto">
    <a class="unset-all text-body" asp-action="Index" asp-route-page="1" asp-route-startDate="@Model.SelectedStartDate.AddDays(-1).ToString("yyyy-MM-dd")">
        <i class="fas fa-chevron-left"></i>
    </a>
    <span class="fw-bold px-1 text-capitalize">
        @Model.SelectedStartDate.ToString("ddd dd-MM-yyyy", CultureInfo.GetCultureInfo("nl-NL"))
    </span>
    <a class="unset-all text-body" asp-action="Index" asp-route-page="1" asp-route-startDate="@Model.SelectedStartDate.AddDays(1).ToString("yyyy-MM-dd")">
        <i class="fas fa-chevron-right"></i>
    </a>
</div>

<div class="table-container">
    <table class="table">
        <thead>
            <tr>
                <th>Werknemer</th>
                <th>Gewerkte tijden</th>
                <th>Pauze</th>
                <th>Gewerkte uren</th>
                <th>Ingepland rooster</th>
                <th>Status</th>
                <th>Acties</th>
            </tr>
        </thead>
        <tbody>
            @if (!Model.WorkedHours.Any())
            {
                <tr>
                    <td colspan="100%" class="text-center py-4">Er zijn nog geen gewerkte uren</td>
                </tr>
            }
            else
            {
                @foreach (var workedHour in Model.WorkedHours)
                {
                    <tr>
                        <td>
                            @(workedHour.Employee != null
                                ? $"{workedHour.Employee.FirstName} {workedHour.Employee.LastName}"
                                : "Geen werknemer")
                        </td>
                        <td>@workedHour.StartTime - @workedHour.EndTime</td>
                        <td>
                            @if (workedHour.BreaksDuration.HasValue)
                            {
                                <div>@workedHour.BreaksDuration.Value.ToString(@"hh\:mm")</div>
                            }
                            else
                            {
                                <div>-</div>
                            }
                        </td>
                        <td>90</td>
                        <td>
                            @if (workedHour.Employee != null)
                            {
                                @workedHour.Employee.Shifts.Count()
                            }
                            else
                            {
                                @:Geen werknemer
                            }
                        </td>
                        <td>@workedHour.Status</td>
                        <td>
                            @if (workedHour.IsFuture)
                            {
                                <a asp-action="Edit" asp-route-id="@workedHour.PlannedShift.Id">
                                    <img width="20px" src="~/img/update-icon.svg" alt="edit" />
                                </a>
                            }
                            else
                            {
                                <span>-</span>
                            }
                        </td>
                    </tr>
                }
            }
        </tbody>
    </table>

    @if (ViewBag.MaxPages > 1)
    {
        <Component type="typeof(Pagination)"
                   render-mode="ServerPrerendered"
                   param-PageNumber="ViewBag.PageNumber"
                   param-MaxPages="ViewBag.MaxPages" />
    }
</div>